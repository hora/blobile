(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{v2dp:function(e,t,i){"use strict";i.r(t),i.d(t,"LiveFeedPageModule",(function(){return re}));var s=i("TEn/"),n=i("ofXK"),o=i("3Pt+"),a=i("fXoL");let r=(()=>{class e{}return e.\u0275mod=a.Hb({type:e}),e.\u0275inj=a.Gb({factory:function(t){return new(t||e)},imports:[[n.b,s.G]]}),e})();var d,l=i("tyNb"),c=i("mrSG"),h=i("HDdC"),u=i("gcOT");!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=2]="CLOSED"}(d||(d={}));var m=function(e,t,i,s){return new(i||(i=Promise))((function(n,o){function a(e){try{d(s.next(e))}catch(t){o(t)}}function r(e){try{d(s.throw(e))}catch(t){o(t)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,r)}d((s=s.apply(e,t||[])).next())}))};const g=new class extends u.b{constructor(){super({name:"EventSource",platforms:["web"]})}configure(e){return m(this,void 0,void 0,(function*(){if(console.debug(`EventSourceWeb.configure(${e.url})`),!e.url)throw new Error("url is required");this.url=e.url}))}open(){return m(this,void 0,void 0,(function*(){if(console.debug("EventSourceWeb.open()"),!this.url)throw new Error("call configure first");this.eventSource=new window.EventSource(this.url),this.notifyListeners("readyStateChanged",{state:d.CONNECTING}),this.eventSource.addEventListener("error",e=>{this.notifyListeners("error",{error:null==e?void 0:e.message})}),this.eventSource.addEventListener("message",e=>{this.notifyListeners("message",{message:null==e?void 0:e.data})}),this.eventSource.addEventListener("open",e=>{this.notifyListeners("open",{message:null==e?void 0:e.message}),this.notifyListeners("readyStateChanged",{state:d.OPEN})})}))}close(){return m(this,void 0,void 0,(function*(){console.debug("EventSourceWeb.close()"),this.eventSource&&(this.eventSource.close(),this.notifyListeners("readyStateChanged",{state:d.CLOSED}))}))}};Object(u.c)(g);const{App:b,Device:f,EventSource:v,Network:p}=u.a;class y{constructor(){this.isConnected=!0,this.lastUpdated=0,this.lastRetry=0,this.maxRetryMillis=6e5,this.handles={},this.defaultRetryMillis=1e4,this.defaultCheckIntervalMillis=5e3,this.defaultRetryFallback=1.2,this.retryMillis=this.defaultRetryMillis,console.debug(`APIStream(): default retry:          ${this.defaultRetryMillis}ms`),console.debug(`APIStream(): default check interval: ${this.defaultCheckIntervalMillis}ms`),console.debug(`APIStream(): default retry fallback: ${this.defaultRetryFallback}x`),f.getInfo().then(e=>{this.deviceInfo=e,"web"!==this.deviceInfo.platform?this.init("https://www.blaseball.com/events/streamData"):this.init()}).catch(e=>{console.error("APIStream(): failed to get device info, assuming web",e),this.deviceInfo={platform:"web"},this.init()})}init(e){return Object(c.a)(this,void 0,void 0,(function*(){console.debug("APIStream.init(): initializing."),this.isStarted=!1,this.observable=h.a.create(e=>{this.observer=e}),e?(console.debug("APIStream.init(): pre-configured URL: "+e),this.url=e):this.url="https://cors-proxy.blaseball-reference.com/events/streamData";try{this.isActive=(yield b.getState()).isActive}catch(t){console.error("APIStream.init(): failed to get app state, assuming active.",t),this.isActive=!0}try{this.isConnected=(yield p.getStatus()).connected}catch(t){console.error("APIStream.init(): failed to get connection state, assuming connected.",t),this.isConnected=!0}b.addListener("appStateChange",e=>Object(c.a)(this,void 0,void 0,(function*(){const t=this.isActive;console.debug(`APIStream.init() isActive: ${t} -> ${e.isActive}`),!t&&e.isActive?yield this.handleSystemChange(!0):e.isActive&&(yield this.handleSystemChange())}))),p.addListener("networkStatusChange",e=>Object(c.a)(this,void 0,void 0,(function*(){console.debug(`APIStream.init() isConnected: ${this.isConnected} -> ${e.connected}`),e.connected&&(yield this.handleSystemChange(!0))})))}))}handleSystemChange(e){return Object(c.a)(this,void 0,void 0,(function*(){console.debug("APIStream.handleSystemChange(): retrigger="+e),this.isStarted?!e&&this.source||(console.debug("APIStream.handleSystemChange(): (re)creating connection"),yield this.createSource(),this.startCheckingLastUpdated()):(console.debug("APIStream.handleSystemChange(): shutting down"),this.retryChecker&&(clearInterval(this.retryChecker),this.retryChecker=null),yield this.closeSource(),this.source=null)}))}start(){return console.info("APIStream.start()"),this.isStarted=!0,this.handleSystemChange(),this.observable}stop(){console.info("APIStream.stop()"),this.isStarted=!1,this.handleSystemChange(),this.observer.complete(),this.observer=null,this.observable=null,this.retryMillis=this.defaultRetryMillis,this.lastUpdated=0}retry(){return Object(c.a)(this,void 0,void 0,(function*(){return console.debug("APIStream.retry()"),new Promise((e,t)=>{try{this.lastRetry=Date.now(),this.closeSource();const t=Math.floor(Math.min(this.maxRetryMillis,this.retryMillis*this.defaultRetryFallback));console.debug(`APIStream.retry(): ${this.retryMillis} -> ${t}`),this.retryMillis=t,e(this.createSource())}catch(i){t(i)}})}))}onMessage(e){console.debug("APIStream.onMessage()");const t=new MessageEvent("message",{data:e});this.lastUpdate!==t.data&&(this.retryMillis!==this.defaultRetryMillis&&(console.debug(`APIStream.onMessage(): ${this.retryMillis} -> ${this.defaultRetryMillis}`),this.retryMillis=this.defaultRetryMillis),this.lastUpdated=Date.now(),this.lastUpdate=t.data,this.observer&&this.observer.next(t))}createSource(){return Object(c.a)(this,void 0,void 0,(function*(){return console.debug("APIStream.createSource()"),new Promise((e,t)=>Object(c.a)(this,void 0,void 0,(function*(){yield this.closeSource();const i=v;this.source=i,yield i.configure({url:this.url}),this.handles.message=i.addListener("message",t=>{this.onMessage(t.message),e(!0)}),this.handles.error=i.addListener("error",e=>{if(console.error("APIStream.createSource(): An error occurred reading from the event source.  Resetting.",e.error),t(!0),this.observer){const t=new ErrorEvent("error",{message:e.error});this.observer.next(t)}else console.debug("APIStream.createSource(): No observer?");this.checkLastUpdated()}),yield i.open()})))}))}closeSource(){return Object(c.a)(this,void 0,void 0,(function*(){try{if(this.source){for(const e of Object.keys(this.handles))this.handles[e].remove();this.handles={},yield this.source.close(),this.source=null}}catch(e){console.warn("APIStream.closeSource(): failed to close event source:",e)}}))}startCheckingLastUpdated(){console.debug("APIStream.startCheckingLastUpdated()"),this.retryChecker&&clearInterval(this.retryChecker),setTimeout(()=>{this.retryChecker=setInterval(()=>{this.checkLastUpdated()},this.defaultCheckIntervalMillis)},this.defaultCheckIntervalMillis)}checkLastUpdated(){const e=Math.max(this.lastUpdated,this.lastRetry),t=Date.now();this.hourChecker||(this.hourChecker=setTimeout(()=>{console.debug("APIStream.checkLastUpdate(): new hour, force a check."),this.checkLastUpdated()},t-t%36e5+36e5));const i=Math.round(this.lastRetry%36e5/36e5*100),s=Math.round(t%36e5/36e5*100);s<i&&(console.debug(`APIStream.checkLastUpdated(): hour reset (${s} < ${i})`),this.retryMillis=this.defaultRetryMillis,clearTimeout(this.hourChecker),this.hourChecker=null);const n=e+this.retryMillis;console.debug(`APIStream.checkLastUpdated(): now=${this.formatDate(t)}, lastUpdated=${this.formatDate(this.lastUpdated)}, lastRetry=${this.formatDate(this.lastRetry)}, threshold=${this.formatDate(n)}, retryMillis=${(this.retryMillis/1e3/1).toPrecision(2)}s`),t>n?this.retry():console.debug(`APIStream.checkLastUpdated(): ${this.formatDate(t)} < ${this.formatDate(n)}`)}formatDate(e){return("number"==typeof e?new Date(e):e).toISOString()}}class w{constructor(e){this.data=e,void 0===this.data&&(this.data={})}incremented(e){let t=this.data&&this.data[e];return void 0===t&&(t=-1),t+1}defineStrings(e){for(const t of e)Object.defineProperty(this,t,{get:()=>this.data[t]})}defineNumbers(e){for(const t of e)Object.defineProperty(this,t,{get:()=>this.data[t]})}defineIncrementedNumbers(e){for(const t of e)Object.defineProperty(this,t,{get:()=>this.incremented(t)})}defineBooleans(e){for(const t of e)Object.defineProperty(this,t,{get:()=>Boolean(this.data[t])})}}class k extends w{constructor(e){super(e),this.defineStrings(["eraColor","eraTitle","id","league","playoffs","rules","seasonId","subEraColor","subEraTitle","terminology"]),this.defineIncrementedNumbers(["day","playoffRound","season"]),this.defineNumbers(["phase"])}isPreseason(){const e=new Date(this.data.nextSeasonStart).getTime();if(0===this.data.day&&e>Date.now())return!0}isRegularSeason(){var e;return!this.isPreseason()&&void 0!==(null===(e=this.data)||void 0===e?void 0:e.day)&&this.data.day<99}isPostseason(){var e;return!this.isPreseason()&&void 0!==(null===(e=this.data)||void 0===e?void 0:e.day)&&this.data.day>=99}isPostseasonComplete(){return!(!this.data.nextElectionEnd||!this.data.nextPhaseTime||this.data.nextElectionEnd!==this.data.nextPhaseTime)||0===this.phase||this.isPreseason()}countdownToNextPhase(e){const t=e||Date.now(),i=new Date(this.data.nextPhaseTime).getTime(),s=Math.floor((i-t)/1e3),n={hours:Math.floor(s/60/60)};let o=s-60*n.hours*60;return n.minutes=Math.floor(o/60),n.seconds=o-60*n.minutes,n}countdownToNextSeason(e){const t=e||Date.now(),i=new Date(this.data.nextSeasonStart).getTime(),s=Math.floor((i-t)/1e3),n={hours:Math.floor(s/60/60)};let o=s-60*n.hours*60;return n.minutes=Math.floor(o/60),n.seconds=o-60*n.minutes,n}get nextSeasonStart(){return this.data.nextSeasonStart?new Date(this.data.nextSeasonStart):void 0}get nextPhaseTime(){return this.data.nextPhaseTime?new Date(this.data.nextPhaseTime):void 0}get nextElectionEnd(){return this.data.nextElectionEnd?new Date(this.data.nextElectionEnd):void 0}}class M extends w{constructor(e){super(e),this.defineStrings(["id","league","rules","schedule","standings","stats","terminology"]),this.defineIncrementedNumbers(["seasonNumber"])}}class S extends w{constructor(e){super(e),this.defineStrings(["id"])}get records(){const e=[];for(const t of Object.keys(this.data.losses||{}))e.push({id:t,wins:this.data.wins[t],losses:this.data.losses[t]});return e}}class L extends w{get id(){var e;return null===(e=this.data)||void 0===e?void 0:e.id}get name(){var e;return null===(e=this.data)||void 0===e?void 0:e.name}get numberOfRounds(){return this.incremented("numberOfRounds")}get playoffDay(){return this.incremented("playoffDay")}get rounds(){var e;return(null===(e=this.data)||void 0===e?void 0:e.rounds)||[]}get season(){return this.incremented("season")}get tomorrowRound(){return this.incremented("tomorrowRound")}get winner(){var e;return null===(e=this.data)||void 0===e?void 0:e.winner}}class x extends w{constructor(e){super(e),this.defineStrings(["id","name"]),this.defineBooleans(["special"]),this.defineNumbers(["gameIndex"]),this.defineIncrementedNumbers(["roundNumber"])}}class C extends w{get playoffs(){var e;return new L(null===(e=this.data)||void 0===e?void 0:e.playoffs)}get round(){var e;return new x(null===(e=this.data)||void 0===e?void 0:e.round)}}class I extends w{constructor(e){super(e),this.defineStrings(["id","awayBatter","awayBatterName","awayPitcher","awayPitcherName","awayTeam","awayTeamColor","awayTeamEmoji","awayTeamName","awayTeamNickname","homeBatter","homeBatterName","homePitcher","homePitcherName","homeTeam","homeTeamColor","homeTeamEmoji","homeTeamName","homeTeamNickname","lastUpdate","rules","statsheet","terminology"]),this.defineNumbers(["atBatBalls","atBatStrikes","awayOdds","awayScore","awayTeamBatterCount","baseRunnerCount","halfInningOuts","halfInningScore","homeScore","homeTeamBatterCount","phase","seriesIndex","seriesLength","weather"]),this.defineIncrementedNumbers(["day","inning","season"]),this.defineBooleans(["finalized","gameComplete","gameStart","isPostseason","topOfInning"])}get baseRunnerNames(){var e;return(null===(e=this.data)||void 0===e?void 0:e.baseRunnerNames)||[]}get baseRunners(){var e;return(null===(e=this.data)||void 0===e?void 0:e.baseRunners)||[]}get basesOccupied(){var e;return(null===(e=this.data)||void 0===e?void 0:e.basesOccupied)||[]}get outcomes(){var e;return(null===(e=this.data)||void 0===e?void 0:e.outcomes)||[]}}class P extends w{get sim(){var e;return new k(null===(e=this.data)||void 0===e?void 0:e.sim)}get season(){var e;return new M(null===(e=this.data)||void 0===e?void 0:e.season)}get standings(){var e;return new S(null===(e=this.data)||void 0===e?void 0:e.standings)}get schedule(){var e,t;return(null===(t=null===(e=this.data)||void 0===e?void 0:e.schedule)||void 0===t?void 0:t.map(e=>new I(e)))||[]}get tomorrowSchedule(){var e,t;return(null===(t=null===(e=this.data)||void 0===e?void 0:e.tomorrowSchedule)||void 0===t?void 0:t.map(e=>new I(e)))||[]}get postseason(){var e;return new C(null===(e=this.data)||void 0===e?void 0:e.postseason)}}class j extends w{get id(){return this.data.id}get name(){return this.data.name}get teams(){return this.data.teams||[]}}class z extends w{constructor(e){super(e),this.defineStrings(["id","emoji","fullName","location","mainColor","nickname","secondaryColor","shorthand","slogan"]),this.defineNumbers(["championships","seasonShames","seasonShamings","shameRuns","totalShames","totalShamings"])}get bench(){return this.data.bench||[]}get bullpen(){return this.data.bullpen||[]}get lineup(){return this.data.lineup||[]}get rotation(){return this.data.rotation||[]}}class O extends w{get id(){var e;return null===(e=this.data)||void 0===e?void 0:e.id}get name(){var e;return null===(e=this.data)||void 0===e?void 0:e.name}get subleagues(){var e;return(null===(e=this.data)||void 0===e?void 0:e.subleagues)||[]}get tiebreakers(){var e;return null===(e=this.data)||void 0===e?void 0:e.tiebreakers}}class N extends w{get id(){return this.data.id}get name(){return this.data.name}get divisions(){return this.data.divisions||[]}}class T extends w{get divisions(){var e;return(null===(e=this.data.divisions)||void 0===e?void 0:e.map(e=>new j(e)))||[]}get teams(){var e;return(null===(e=this.data.teams)||void 0===e?void 0:e.map(e=>new z(e)))||[]}get leagues(){var e;return(null===(e=this.data.leagues)||void 0===e?void 0:e.map(e=>new O(e)))||[]}get subleagues(){var e;return(null===(e=this.data.leagues)||void 0===e?void 0:e.map(e=>new N(e)))||[]}}class A extends w{get games(){var e;return new P(null===(e=this.data)||void 0===e?void 0:e.games)}get leagues(){var e;return new T(null===(e=this.data)||void 0===e?void 0:e.leagues)}get season(){var e,t;if(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.season)return new M(this.data.games.season)}get sim(){var e,t;if(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.sim)return new k(this.data.games.sim)}get postseason(){var e,t;if(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.postseason)return new C(this.data.games.postseason)}get round(){var e,t,i;if(null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.postseason)||void 0===i?void 0:i.round)return new x(this.data.games.postseason.round)}get playoffs(){var e,t,i;if(null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.postseason)||void 0===i?void 0:i.playoffs)return new L(this.data.games.postseason.playoffs)}}const{Storage:E}=u.a;let D=(()=>{class e{constructor(){this.settings={segment:"all",favorites:{}},console.debug("SettingsService instantiated."),this.ready=this.init()}init(){return Object(c.a)(this,void 0,void 0,(function*(){console.debug("SettingsService initializing."),this.assertSettings();try{const e=yield E.get({key:"favorites"});e&&void 0!==e.value&&(this.settings.favorites=JSON.parse(e.value));const t=yield E.get({key:"segment"});this.settings.segment=(null==t?void 0:t.value)||"all"}catch(e){console.error("SettingsService.init(): failed to initialize settings.",e),this.settings={segment:"all",favorites:{}}}return console.debug("SettingsService.init(): settings=",this.settings),!0}))}assertSettings(){this.settings||(this.settings={}),this.settings.favorites||(this.settings.favorites={}),this.settings.segment||(this.settings.segment="all")}isFavorite(e){return this.assertSettings(),Boolean(this.settings.favorites[e])}setFavorite(e,t){return Object(c.a)(this,void 0,void 0,(function*(){return this.assertSettings(),this.settings.favorites[e]=t,E.set({key:"favorites",value:JSON.stringify(this.settings.favorites)}).then(()=>(console.debug(`set favorite: ${e} = ${t}`),t))}))}toggleFavorite(e){return Object(c.a)(this,void 0,void 0,(function*(){return this.assertSettings(),this.setFavorite(e,!this.isFavorite(e))}))}getSegment(){return this.assertSettings(),this.settings.segment}setSegment(e){return Object(c.a)(this,void 0,void 0,(function*(){return this.assertSettings(),this.settings.segment=e,E.set({key:"segment",value:e}).then(()=>(console.debug("set segment: "+e),e))}))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function R(e,t){1&e&&a.Kb(0,"ion-icon",20)}function U(e,t){1&e&&a.Kb(0,"ion-icon",21)}function F(e,t){1&e&&a.Kb(0,"ion-icon",20)}function B(e,t){1&e&&a.Kb(0,"ion-icon",21)}function $(e,t){if(1&e&&(a.Wb(),a.Mb(0,"svg",22),a.Mb(1,"g",23),a.Kb(2,"path",24),a.Kb(3,"path",25),a.Kb(4,"path",26),a.Kb(5,"path",27),a.Kb(6,"rect",28),a.Kb(7,"path",29),a.Kb(8,"path",30),a.Kb(9,"rect",31),a.Kb(10,"path",32),a.Kb(11,"path",33),a.Kb(12,"rect",34),a.Kb(13,"rect",35),a.Kb(14,"rect",36),a.Kb(15,"path",37),a.Kb(16,"rect",38),a.Kb(17,"rect",39),a.Kb(18,"path",40),a.Mb(19,"text",41),a.jc(20),a.Lb(),a.Mb(21,"text",42),a.jc(22),a.Lb(),a.Mb(23,"text",43),a.jc(24),a.Lb(),a.Mb(25,"text",44),a.jc(26),a.Lb(),a.Mb(27,"text",45),a.jc(28),a.Lb(),a.Lb(),a.Lb()),2&e){const e=a.Xb();a.zb(19),a.Ab("x",e.coordinates.first[0])("y",e.coordinates.first[1])("font-size",e.playerFontSize),a.zb(1),a.kc(e.getName(e.getBaseRunner(0))),a.zb(1),a.Ab("x",e.coordinates.second[0])("y",e.coordinates.second[1])("font-size",e.playerFontSize),a.zb(1),a.kc(e.getName(e.getBaseRunner(1))),a.zb(1),a.Ab("x",e.coordinates.third[0])("y",e.coordinates.third[1])("font-size",e.playerFontSize),a.zb(1),a.kc(e.getName(e.getBaseRunner(2))),a.zb(1),a.Ab("font-size",e.playerFontSize),a.zb(1),a.kc(e.getName(e.getBatter())),a.zb(1),a.Ab("font-size",e.playerFontSize),a.zb(1),a.kc(e.getName(e.getPitcher()))}}function K(e,t){if(1&e&&(a.Mb(0,"span"),a.jc(1),a.Lb()),2&e){const e=a.Xb(2);a.zb(1),a.lc("(",e.game.inning,")")}}function _(e,t){if(1&e&&(a.Mb(0,"ion-col",46),a.Mb(1,"div"),a.jc(2,"FINAL "),a.ic(3,K,2,1,"span",47),a.Lb(),a.Lb()),2&e){const e=a.Xb();a.zb(3),a.ac("ngIf",e.game.inning>8)}}function X(e,t){if(1&e&&(a.Mb(0,"ion-col",46),a.Mb(1,"div"),a.jc(2,"INNING\xa0"),a.Mb(3,"div",48),a.Kb(4,"div",49),a.jc(5),a.Lb(),a.Lb(),a.Lb()),2&e){const e=a.Xb();a.zb(4),a.ac("innerHTML",e.game.topOfInning?"\u25b2":"\u25bc",a.ec),a.zb(1),a.lc(" ",e.game.inning,"")}}let G=(()=>{class e{constructor(e){this.settings=e,this.refresh=new a.n,this.playerFontSize="1.1rem",this.coordinates={first:[430,355],second:[328,190],third:[225,355]},console.debug("Diamond component created.")}ngOnInit(){return Object(c.a)(this,void 0,void 0,(function*(){return console.debug("Diamond component initialized."),console.debug(this.game),this.settings.ready}))}isFavorite(e){return this.settings.isFavorite(e)}toggleFavorite(e){this.settings.toggleFavorite(e),this.refresh&&(console.debug("toggleFavorite(): refreshing"),this.refresh.emit())}inProgress(){return this.game&&!this.game.gameComplete}getName(e){return e&&e.name?e.name:null}getBaseRunner(e){if(this.inProgress())for(let t=0;t<this.game.basesOccupied.length;t++)if(this.game.basesOccupied[t]===e)return{name:this.game.baseRunnerNames[t],id:this.game.baseRunners[t]};return null}getPitcher(){return this.inProgress()?this.game.topOfInning?{id:this.game.homePitcher,name:this.game.homePitcherName}:{id:this.game.awayPitcher,name:this.game.awayPitcherName}:null}getBatter(){if(this.inProgress())return this.game.topOfInning?{id:this.game.awayBatter,name:this.game.awayBatterName}:{id:this.game.homeBatter,name:this.game.homeBatterName}}getEmoji(e){switch(e){case"home":return String.fromCodePoint(this.game.homeTeamEmoji);case"away":return String.fromCodePoint(this.game.awayTeamEmoji);default:return""}}}return e.\u0275fac=function(t){return new(t||e)(a.Jb(D))},e.\u0275cmp=a.Db({type:e,selectors:[["app-diamond"]],inputs:{game:"game"},outputs:{refresh:"refresh"},decls:57,vars:21,consts:[[1,"green-card","ion-no-padding","ion-no-margin"],["color","transparent",1,"ion-no-padding"],["color","transparent"],["slot","start"],["fill","clear","shape","round","size","large",3,"click"],["name","star-outline",4,"ngIf"],["name","star",4,"ngIf"],[1,"ion-no-padding"],[1,"team-header"],[1,"team-lozenge"],[1,"team-emoji",3,"innerHTML"],["slot","end"],[0,"xmlns","svg","http://www.w3.org/2000/svg","xmlns","http://www.w3.org/2000/svg",0,"xmlns","sodipodi","http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd",0,"xmlns","inkscape","http://www.inkscape.org/namespaces/inkscape","id","diamond","version","1.0","preserveAspectRatio","xMinYMin meet","viewBox","0 120 650 390",4,"ngIf"],[1,"scorebox"],[1,"ion-align-items-end","ion-text-end"],[1,"scorebox-box"],["class","ion-text-end",4,"ngIf"],["size","12"],[1,"scorebox-border"],["id","lastUpdate",1,"rotate-display"],["name","star-outline"],["name","star"],[0,"xmlns","svg","http://www.w3.org/2000/svg","xmlns","http://www.w3.org/2000/svg",0,"xmlns","sodipodi","http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd",0,"xmlns","inkscape","http://www.inkscape.org/namespaces/inkscape","id","diamond","version","1.0","preserveAspectRatio","xMinYMin meet","viewBox","0 120 650 390"],["id","main"],["id","background","d","M 150,520 L 0,520 L 0,0 L 650,0 L 650,520 L 508,520 L 150,520 z ",0,"sodipodi","nodetypes","ccccccc",2,"fill","#00a831","fill-opacity","1","fill-rule","evenodd","stroke","none","stroke-width","1px","stroke-linecap","butt","stroke-linejoin","miter","stroke-opacity","1"],["id","dirt",0,"sodipodi","type","arc",0,"sodipodi","cx","300",0,"sodipodi","cy","752.36218",0,"sodipodi","rx","95",0,"sodipodi","ry","95","d","M 205,752.36218 A 95,95 0 0 1 395,752.36218",0,"sodipodi","start","3.1415927",0,"sodipodi","end","6.2831853",0,"sodipodi","open","true","transform","matrix(1.989102,0,0,1.978205,-268.2308,-1169.879)",2,"opacity","1","fill","#a48e28","fill-opacity","1","stroke","#85881b","stroke-width","1.04379344","stroke-linecap","butt","stroke-linejoin","bevel","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","dirt-corner-right","d","M 328.5,439.48263 L 538.5,229.48266 L 538.5,439.48263 L 328.5,439.48263 z ",2,"fill","#00a831","fill-opacity","1","fill-rule","evenodd","stroke","none","stroke-width","1px","stroke-linecap","butt","stroke-linejoin","miter","stroke-opacity","1"],["id","dirt-corner-left","d","M 328.5,439.48263 L 124.5,235.48266 L 123.5,439.48263 L 328.5,439.48263 z ",2,"fill","#00a831","fill-opacity","1","fill-rule","evenodd","stroke","none","stroke-width","1px","stroke-linecap","butt","stroke-linejoin","miter","stroke-opacity","1"],["id","diamond-grass","width","168.31494","height","168.31494","x","-77.781464","y","374.03622","transform","matrix(0.707107,-0.707107,0.707107,0.707107,0,0)",2,"opacity","1","fill","#00a837","fill-opacity","1","stroke","#85881b","stroke-width","4.99999857","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","dirt-home",0,"sodipodi","type","arc",0,"sodipodi","cx","328",0,"sodipodi","cy","430",0,"sodipodi","rx","43",0,"sodipodi","ry","43","d","M 371 430 A 43 43 0 1 1  285,430 A 43 43 0 1 1  371 430 z",2,"opacity","1","fill","#85881b","fill-opacity","1","stroke","none","stroke-width","1","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","pitchers-mound",0,"sodipodi","type","arc",0,"sodipodi","cx","300",0,"sodipodi","cy","752.36218",0,"sodipodi","rx","18",0,"sodipodi","ry","18","d","M 318 752.36218 A 18 18 0 1 1  282,752.36218 A 18 18 0 1 1  318 752.36218 z","transform","translate(28.5,-432.8794)",2,"opacity","1","fill","#b56700","fill-opacity","1","stroke","#85881b","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","pitchers-plate","width","14","height","4","x","321.5","y","317.4827",2,"opacity","1","fill","white","fill-opacity","1","stroke","none","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","foul-line-right","d","M 363.00993,405 C 650.37706,117.62236 650.37706,117.62236 650.37706,117.62236",2,"fill","none","fill-opacity","0.75","fill-rule","evenodd","stroke","white","stroke-width","3.01047993","stroke-linecap","square","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","foul-line-left","d","M 293.77042,404.99993 C -2.1085256,109.12113 -2.1085256,109.12113 -2.1085256,109.12113",2,"fill","none","fill-opacity","0.75","fill-rule","evenodd","stroke","white","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","base-1","width","10.242652","height","10.242652","x","531.56042","y","-95.300102","transform","matrix(0.707107,0.707107,-0.707107,0.707107,0,0)",2,"opacity","1","fill","white","fill-opacity","1","stroke","none","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","base-2","width","10.242655","height","10.242655","x","369.26904","y","-95.643242","transform","matrix(0.707107,0.707107,-0.707107,0.707107,0,0)",2,"opacity","1","fill","white","fill-opacity","1","stroke","none","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","base-3","width","10.242649","height","10.242649","x","369.26904","y","66.99128","transform","matrix(0.707107,0.707107,-0.707107,0.707107,0,0)",2,"opacity","1","fill","white","fill-opacity","1","stroke","none","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","base-home","d","M 320,423 L 335,423 L 335,430.7492 L 327.72761,438 L 320,429.78055 L 320,423 z ",0,"sodipodi","nodetypes","cccccc",2,"fill","white","fill-opacity","1","stroke","none","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-opacity","1"],["id","batters-box-right","width","15","height","35","x","340","y","410",2,"opacity","1","fill","#85881b","fill-opacity","1","stroke","white","stroke-width","1","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","batters-box-left","width","15","height","35","x","300","y","410",2,"opacity","1","fill","#85881b","fill-opacity","1","stroke","white","stroke-width","1","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","border-home","d","M 295,405 C 295.15103,402.74278 293.1875,403.97917 292.28125,403.46875 C 280.62645,419.16193 280.35712,439.683 291.625,455.65625 C 305.77503,475.71519 333.59731,480.52502 353.65625,466.375 C 373.71519,452.22497 378.52502,424.40269 364.375,404.34375 L 361,405 C 362.65625,407.375 361,405 362.65625,407.375 L 293.875,406.53125 L 295,405 z M 293.875,406.53125 L 362.65625,407.375 C 374.80016,425.99135 370.24983,450.98832 351.9375,463.90625 C 333.20494,477.12061 307.30812,472.67006 294.09375,453.9375 C 283.82751,439.38417 283.83997,421.05606 293.875,406.53125 z ",0,"sodipodi","nodetypes","ccsscccccccssc",2,"opacity","1","fill","white","fill-opacity","1","stroke","none","stroke-width","3","stroke-linecap","butt","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["id","player-1","text-anchor","start","font-family","sans-serif","font-weight","bold","fill","white"],["id","player-2","text-anchor","middle","font-family","sans-serif","font-weight","bold","fill","white"],["id","player-3","text-anchor","end","font-family","sans-serif","font-weight","bold","fill","white"],["id","player-home","x","328","y","500","text-anchor","middle","font-family","sans-serif","font-weight","bold","fill","white"],["id","pitcher","x","328","y","296","text-anchor","middle","font-family","sans-serif","font-weight","bold","fill","white"],[1,"ion-text-end"],[4,"ngIf"],[1,"scorebox-inning"],[1,"inning-marker",3,"innerHTML"]],template:function(e,t){1&e&&(a.Mb(0,"ion-card",0),a.Mb(1,"ion-card-header",1),a.Mb(2,"ion-toolbar",2),a.Mb(3,"ion-buttons",3),a.Mb(4,"ion-button",4),a.Ub("click",(function(){return t.toggleFavorite(t.game.awayTeam)})),a.ic(5,R,1,0,"ion-icon",5),a.ic(6,U,1,0,"ion-icon",6),a.Lb(),a.Lb(),a.Mb(7,"ion-title",7),a.Mb(8,"div",8),a.Mb(9,"div",9),a.Kb(10,"span",10),a.jc(11),a.Lb(),a.jc(12," at "),a.Mb(13,"div",9),a.jc(14),a.Kb(15,"span",10),a.Lb(),a.Lb(),a.Lb(),a.Mb(16,"ion-buttons",11),a.Mb(17,"ion-button",4),a.Ub("click",(function(){return t.toggleFavorite(t.game.homeTeam)})),a.ic(18,F,1,0,"ion-icon",5),a.ic(19,B,1,0,"ion-icon",6),a.Lb(),a.Lb(),a.Lb(),a.Lb(),a.Mb(20,"ion-card-content",7),a.ic(21,$,29,16,"svg",12),a.Mb(22,"ion-grid",13),a.Mb(23,"ion-row",14),a.Mb(24,"ion-col"),a.Mb(25,"div"),a.jc(26,"BALL\xa0"),a.Mb(27,"div",15),a.jc(28),a.Lb(),a.Lb(),a.Lb(),a.Mb(29,"ion-col"),a.Mb(30,"div"),a.jc(31,"STRIKE\xa0"),a.Mb(32,"div",15),a.jc(33),a.Lb(),a.Lb(),a.Lb(),a.Mb(34,"ion-col"),a.Mb(35,"div"),a.jc(36,"OUT\xa0"),a.Mb(37,"div",15),a.jc(38),a.Lb(),a.Lb(),a.Lb(),a.Lb(),a.Mb(39,"ion-row",14),a.Mb(40,"ion-col"),a.Mb(41,"div"),a.jc(42,"AWAY\xa0"),a.Mb(43,"div",15),a.jc(44),a.Lb(),a.Lb(),a.Lb(),a.ic(45,_,4,1,"ion-col",16),a.ic(46,X,6,2,"ion-col",16),a.Mb(47,"ion-col"),a.Mb(48,"div"),a.jc(49,"HOME\xa0"),a.Mb(50,"div",15),a.jc(51),a.Lb(),a.Lb(),a.Lb(),a.Lb(),a.Mb(52,"ion-row"),a.Mb(53,"ion-col",17),a.Mb(54,"div",18),a.Mb(55,"div",19),a.jc(56),a.Lb(),a.Lb(),a.Lb(),a.Lb(),a.Lb(),a.Lb(),a.Lb()),2&e&&(a.zb(5),a.ac("ngIf",!t.isFavorite(t.game.awayTeam)),a.zb(1),a.ac("ngIf",t.isFavorite(t.game.awayTeam)),a.zb(4),a.hc("background-color: "+t.game.awayTeamColor),a.ac("innerHTML",t.getEmoji("away"),a.ec),a.zb(1),a.lc(" ",t.game.awayTeamNickname," "),a.zb(3),a.lc(" ",t.game.homeTeamNickname," "),a.zb(1),a.hc("background-color: "+t.game.homeTeamColor),a.ac("innerHTML",t.getEmoji("home"),a.ec),a.zb(3),a.ac("ngIf",!t.isFavorite(t.game.homeTeam)),a.zb(1),a.ac("ngIf",t.isFavorite(t.game.homeTeam)),a.zb(2),a.ac("ngIf",t.inProgress()),a.zb(7),a.kc(t.game.atBatBalls),a.zb(5),a.kc(t.game.atBatStrikes),a.zb(5),a.kc(t.game.halfInningOuts),a.zb(6),a.kc(t.game.awayScore),a.zb(1),a.ac("ngIf",t.game.gameComplete),a.zb(1),a.ac("ngIf",!t.game.gameComplete),a.zb(5),a.kc(t.game.homeScore),a.zb(5),a.kc(t.game.lastUpdate))},directives:[s.g,s.i,s.F,s.f,s.e,n.i,s.D,s.h,s.l,s.v,s.j,s.n],styles:[".green-card[_ngcontent-%COMP%]{--color:#fff;--background:#00a831}.team-header[_ngcontent-%COMP%]{color:#fff;font-size:3.5vw;font-weight:700;text-align:center}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut{0%{opacity:1}to{opacity:0}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}.scorebox[_ngcontent-%COMP%]{font-family:scoreboard,sans-serif;width:95%;margin-left:auto;margin-right:auto;margin-bottom:.75em;text-align:center;background-color:#000;border:5px solid #fff;font-size:3.1vw;font-weight:700}.scorebox[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5em}.scorebox[_ngcontent-%COMP%]   .scorebox-border[_ngcontent-%COMP%]{font-family:scoreboard,sans-serif;border:2px solid #ff0;display:inline-block;text-align:left;padding:.1em .5em;width:100%;height:6em}.scorebox[_ngcontent-%COMP%]   .scorebox-box[_ngcontent-%COMP%]{padding:.1em .25em}.scorebox[_ngcontent-%COMP%]   .scorebox-box[_ngcontent-%COMP%], .scorebox[_ngcontent-%COMP%]   .scorebox-inning[_ngcontent-%COMP%]{font-family:scoreboard,sans-serif;border:2px solid #ff0;display:inline-block;text-align:right;width:2.8em}.scorebox[_ngcontent-%COMP%]   .scorebox-inning[_ngcontent-%COMP%]{position:relative;padding:.1em .25em .1em .1em}.scorebox[_ngcontent-%COMP%]   .inning-marker[_ngcontent-%COMP%]{position:absolute;top:.6em;left:.4em;padding:0;margin:0;display:inline-block;font-size:60%;vertical-align:middle}.team-lozenge[_ngcontent-%COMP%]{display:inline-block;margin-top:.25em;margin-bottom:.25em}.team-emoji[_ngcontent-%COMP%]{border:1px solid #008024;border-radius:1em;display:inline-block;width:1.5em;height:1.5em}"]}),e})();function H(e,t){1&e&&(a.Mb(0,"ion-button"),a.Kb(1,"ion-spinner"),a.Lb())}function W(e,t){if(1&e){const e=a.Nb();a.Mb(0,"ion-toolbar"),a.Mb(1,"ion-buttons",8),a.Mb(2,"ion-button"),a.Kb(3,"ion-icon"),a.Lb(),a.Lb(),a.Mb(4,"ion-segment",9),a.Ub("ionChange",(function(t){return a.dc(e),a.Xb().segmentChanged(t)})),a.Mb(5,"ion-segment-button",10),a.Mb(6,"ion-label"),a.jc(7,"All"),a.Lb(),a.Lb(),a.Mb(8,"ion-segment-button",11),a.Mb(9,"ion-label"),a.jc(10,"Active"),a.Lb(),a.Lb(),a.Mb(11,"ion-segment-button",12),a.Mb(12,"ion-label"),a.jc(13,"Favorites"),a.Lb(),a.Lb(),a.Lb(),a.Mb(14,"ion-buttons",2),a.Mb(15,"ion-button",13),a.Ub("click",(function(){return a.dc(e),a.Xb().toggleSearchbar()})),a.Kb(16,"ion-icon",14),a.Lb(),a.Lb(),a.Lb()}if(2&e){const e=a.Xb();a.zb(4),a.ac("value",e.segment)}}function J(e,t){if(1&e){const e=a.Nb();a.Mb(0,"ion-searchbar",15),a.Ub("ionInput",(function(t){return a.dc(e),a.Xb().filterList(t)})),a.Lb()}if(2&e){const e=a.Xb();a.bc("value",e.searchTerm)}}function V(e,t){if(1&e&&(a.Mb(0,"ion-item",16),a.Mb(1,"h4"),a.jc(2,"The "),a.Mb(3,"span"),a.jc(4),a.Lb(),a.jc(5," are the Champions!"),a.Lb(),a.Lb()),2&e){const e=a.Xb(3);a.zb(3),a.hc("color: "+e.getWinner().mainColor),a.zb(1),a.kc(e.getWinner().fullName)}}function Y(e,t){if(1&e&&(a.Mb(0,"span"),a.Mb(1,"ion-item",16),a.Mb(2,"h4"),a.jc(3),a.Lb(),a.Lb(),a.ic(4,V,6,3,"ion-item",17),a.Mb(5,"ion-item",16),a.Mb(6,"h4"),a.jc(7),a.Lb(),a.Lb(),a.Lb()),2&e){const e=a.Xb(2);a.zb(3),a.lc("Season ",e.data.games.season.seasonNumber," is over."),a.zb(1),a.ac("ngIf",e.getWinner()&&e.getWinner().fullName),a.zb(3),a.lc("Next Season Starts In ",e.getNextSeasonStart(),".")}}function q(e,t){if(1&e&&(a.Mb(0,"h4",20),a.jc(1),a.Lb()),2&e){const e=a.Xb(4);a.zb(1),a.mc("Postseason Round ",e.data.games.postseason.round.roundNumber,", Day ",e.getPlayoffDay(),"")}}function Q(e,t){if(1&e&&(a.Mb(0,"ion-item",16),a.ic(1,q,2,2,"h4",19),a.Lb()),2&e){const e=a.Xb(3);a.zb(1),a.ac("ngIf",e.data&&e.data.games)}}function Z(e,t){if(1&e&&(a.Mb(0,"h4",20),a.jc(1),a.Lb()),2&e){const e=a.Xb(4);a.zb(1),a.mc("Season ",e.data.games.season.seasonNumber,", Day ",e.data.games.sim.day,"")}}function ee(e,t){if(1&e&&(a.Mb(0,"ion-item",16),a.ic(1,Z,2,2,"h4",19),a.Lb()),2&e){const e=a.Xb(3);a.zb(1),a.ac("ngIf",e.data&&e.data.games)}}function te(e,t){if(1&e&&(a.Mb(0,"ion-item",16),a.jc(1),a.Lb()),2&e){const e=a.Xb(3);a.zb(1),a.lc(" No more active games for day ",e.data.games.sim.day,". ")}}function ie(e,t){if(1&e){const e=a.Nb();a.Mb(0,"ion-col",21),a.Mb(1,"app-diamond",22),a.Ub("refresh",(function(){return a.dc(e),a.Xb(3).refreshUI()})),a.Lb(),a.Lb()}if(2&e){const e=t.$implicit;a.zb(1),a.ac("game",e)}}function se(e,t){if(1&e&&(a.Mb(0,"span"),a.ic(1,Q,2,1,"ion-item",17),a.ic(2,ee,2,1,"ion-item",17),a.ic(3,te,2,1,"ion-item",17),a.Mb(4,"ion-grid"),a.Mb(5,"ion-row"),a.ic(6,ie,2,1,"ion-col",18),a.Lb(),a.Lb(),a.Lb()),2&e){const e=a.Xb(2);a.zb(1),a.ac("ngIf",e.isPostseason()),a.zb(1),a.ac("ngIf",!e.isPostseason()),a.zb(1),a.ac("ngIf","active"===e.segment&&(!e.games||0===e.games.length)),a.zb(3),a.ac("ngForOf",e.games)("ngForTrackBy",e.gameId)}}function ne(e,t){if(1&e&&(a.Mb(0,"span"),a.ic(1,Y,8,3,"span",3),a.ic(2,se,7,5,"span",3),a.Lb()),2&e){const e=a.Xb();a.zb(1),a.ac("ngIf",e.isFinished()),a.zb(1),a.ac("ngIf",!e.isFinished())}}const oe=[{path:"",component:(()=>{class e{constructor(e,t){this.loadingController=e,this.settings=t,this.data=new A({}),this.games=[],this.segment="all",this.ready=!1,this.errors=0,this.lastUpdate=Date.now(),this.filterVisible=!1,this.stale=!1,this.staleThreshold=3e4,this.api=new y,this.countdown={hours:0,minutes:0,seconds:0}}get schedule(){var e,t;return(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.schedule)||[]}ngOnInit(){return Object(c.a)(this,void 0,void 0,(function*(){return console.debug("Stream.ngOnInit()"),this.showLoading(),this.settings.ready.finally(()=>(this.segment=this.settings.getSegment(),this.startListening(),!0))}))}ngOnDestroy(){return Object(c.a)(this,void 0,void 0,(function*(){return this.ready=!1,this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0,this.api.stop()),!0}))}showLoading(){return Object(c.a)(this,void 0,void 0,(function*(){this.loading=!0}))}hideLoading(){return Object(c.a)(this,void 0,void 0,(function*(){this.loading=!1,this.ready=!0}))}forceRefresh(e){setTimeout(()=>{this.api.retry().finally(()=>{e.target.complete()})},500)}toggleSearchbar(){this.filterVisible=!this.filterVisible,console.debug("Stream.toggleSearchbar(): filterVisible="+this.filterVisible)}filterList(e){return this.searchTerm=e.srcElement.value,this.refreshUI()}getActiveGames(){var e,t;return(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.schedule)?this.data.games.schedule.filter(e=>!e.gameComplete):[]}getFavoriteGames(){var e,t,i,s;return(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.schedule)?null===(s=null===(i=this.data)||void 0===i?void 0:i.games)||void 0===s?void 0:s.schedule.filter(e=>this.settings.isFavorite(e.homeTeam)||this.settings.isFavorite(e.awayTeam)):[]}getSegmentGames(){var e,t;console.debug("Stream.getSegmentGames()");let i=[];switch(this.segment){case"all":i=(null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.schedule)||[];break;case"active":i=this.getActiveGames();break;case"favorites":i=this.getFavoriteGames();break;default:console.warn("Stream.getSegmentGames(): unhandled segment: "+this.segment),i=[]}return i.sort((e,t)=>{const i=e.homeTeamNickname,s=t.homeTeamNickname;return i<s?-1:i>s?1:0})}isPostseason(){var e,t,i;return Boolean(null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.sim)||void 0===i?void 0:i.isPostseason())}isFinished(){var e,t,i;const s=Boolean(null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.sim)||void 0===i?void 0:i.isPostseasonComplete());return this.clockUpdater&&!s?(clearInterval(this.clockUpdater),this.clockUpdater=void 0):!this.clockUpdater&&s&&(this.clockUpdater=setInterval(()=>{this.countdown=this.data.sim.countdownToNextSeason()})),s}getWinner(){var e,t,i,s;const n=null===(s=null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.postseason)||void 0===i?void 0:i.playoffs)||void 0===s?void 0:s.winner;return n?this.data.leagues.teams.find(e=>e.id===n):new z}getPlayoffDay(){var e,t,i,s;return((null===(s=null===(i=null===(t=null===(e=this.data)||void 0===e?void 0:e.games)||void 0===t?void 0:t.postseason)||void 0===i?void 0:i.playoffs)||void 0===s?void 0:s.playoffDay)||-1)+1}getNextSeasonStart(){return`${this.countdown.hours} ${1===this.countdown.hours?"hour":"hours"}, ${this.countdown.minutes} ${1===this.countdown.minutes?"minute":"minutes"}, ${this.countdown.seconds} ${1===this.countdown.seconds?"second":"seconds"}`}refreshUI(){console.debug("Stream.refreshUI()");let e=this.getSegmentGames();return this.searchTerm&&this.searchTerm.length>=2&&(e=e.filter(e=>e.homeTeamName.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1||e.awayTeamName.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1)),this.games=e,this.games}segmentChanged(e){e&&e.detail&&e.detail.value&&(this.segment=e.detail.value,this.settings.setSegment(this.segment)),console.debug("Stream.segmentChanged():",e),this.refreshUI()}checkStale(){const e=this.stale;if(this.games&&this.games.length>0){const e=this.games.find(e=>!e.gameComplete);this.stale=!!e&&this.lastUpdate+this.staleThreshold<Date.now()}console.debug(`Stream.checkStale(): ${e} -> ${this.stale}`)}onEvent(e){if("error"===e.type)return void this.onError(e);this.lastUpdate=Date.now(),setTimeout(()=>{this.errors=0,this.checkStale()},1e3);const t=JSON.parse(e.data).value;this.data||(this.data=new A({}));for(const i of Object.keys(t))this.data.data[i]=t[i];console.debug("Stream.onEvent(): current data:",this.data),this.refreshUI(),this.hideLoading()}onError(e){console.debug("Stream.onError():",e),this.hideLoading(),this.loading=!1,setTimeout(()=>{this.errors++,this.checkStale()},1e3)}startListening(){console.debug("Stream.startListening(): opening event stream to blaseball.com"),this.showLoading();const e=this.api.start();this.subscription=e.subscribe(e=>{this.onEvent(e)},e=>{this.onError(e)})}gameId(e,t){return t&&t.id?t.id:String(e)}}return e.\u0275fac=function(t){return new(t||e)(a.Jb(s.I),a.Jb(D))},e.\u0275cmp=a.Db({type:e,selectors:[["app-live-feed"]],decls:13,vars:5,consts:[[3,"translucent"],["color","primary"],["slot","secondary"],[4,"ngIf"],["slot","fixed",3,"ionRefresh"],["pullingIcon","baseball-outline"],["name","default"],["debounce","200","showCancelButton","focus",3,"value","ionInput",4,"ngIf"],["slot","primary"],[3,"value","ionChange"],["value","all"],["value","active"],["value","favorites"],[3,"click"],["name","search-outline"],["debounce","200","showCancelButton","focus",3,"value","ionInput"],["lines","none"],["lines","none",4,"ngIf"],["size","12",4,"ngFor","ngForOf","ngForTrackBy"],["class","ion-no-margin",4,"ngIf"],[1,"ion-no-margin"],["size","12"],[3,"game","refresh"]],template:function(e,t){1&e&&(a.Mb(0,"ion-header",0),a.Mb(1,"ion-toolbar",1),a.Mb(2,"ion-title"),a.jc(3," Blases Loaded "),a.Lb(),a.Mb(4,"ion-buttons",2),a.ic(5,H,2,0,"ion-button",3),a.Lb(),a.Lb(),a.ic(6,W,17,1,"ion-toolbar",3),a.Lb(),a.Mb(7,"ion-content"),a.Mb(8,"ion-refresher",4),a.Ub("ionRefresh",(function(e){return t.forceRefresh(e)})),a.Mb(9,"ion-refresher-content",5),a.Kb(10,"ion-spinner",6),a.Lb(),a.Lb(),a.ic(11,J,1,1,"ion-searchbar",7),a.ic(12,ne,3,2,"span",3),a.Lb()),2&e&&(a.ac("translucent",!0),a.zb(5),a.ac("ngIf",t.loading||t.stale),a.zb(1),a.ac("ngIf",t.ready&&!t.isFinished()),a.zb(5),a.ac("ngIf",t.filterVisible),a.zb(1),a.ac("ngIf",t.ready))},directives:[s.m,s.F,s.D,s.f,n.i,s.k,s.s,s.t,s.z,s.e,s.n,s.x,s.K,s.y,s.p,s.w,s.L,s.o,s.l,s.v,n.h,s.j,G],styles:[".danger[_ngcontent-%COMP%]{color:#fff;background-color:var(--ion-color-danger);text-align:center;padding:4em}.danger[_ngcontent-%COMP%]   .big[_ngcontent-%COMP%]{font-size:200%;font-weight:700}ion-item[_ngcontent-%COMP%], ion-searchbar[_ngcontent-%COMP%]{transition:.1s ease-in-out}"]}),e})()}];let ae=(()=>{class e{}return e.\u0275mod=a.Hb({type:e}),e.\u0275inj=a.Gb({factory:function(t){return new(t||e)},imports:[[l.i.forChild(oe)],l.i]}),e})(),re=(()=>{class e{}return e.\u0275mod=a.Hb({type:e}),e.\u0275inj=a.Gb({factory:function(t){return new(t||e)},imports:[[s.G,n.b,o.a,ae,r]]}),e})()}}]);